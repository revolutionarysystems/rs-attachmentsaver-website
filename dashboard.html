<!DOCTYPE html>
<html id="dashboard" lang="en">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1.0"/>
  <title>AttachmentSaver - Dashboard</title>

  <!-- CSS  -->
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  <link href="css/materialize.css" type="text/css" rel="stylesheet" media="screen,projection"/>
  <link href="css/style.css" type="text/css" rel="stylesheet" media="screen,projection"/>
  <link href="https://fonts.googleapis.com/css?family=Montserrat:400,700" rel="stylesheet" type="text/css">
  <link href="https://fonts.googleapis.com/css?family=Lato:400,700,400italic,700italic" rel="stylesheet" type="text/css">
</head>
<body class="deep-purple lighten-1 white-text flow-text">

  <div class="navbar-fixed">
    <nav class="blue-grey darken-2" role="navigation">
      <div class="nav-wrapper container">
        <a id="logo-container" href="/" class="brand-logo"><img class="responsive-img" src="img/attachmentsaver-white.png" alt="Logo"></a>
        <div class="right" data-netlify-identity-menu></div>
      </div>
    </nav>
  </div>

  <div class="container">
    <div class="row">
      <div class="col s12">
        <ul id="uiTabs" class="tabs transparent">
          <li class="tab col s3 xdisabled"><a href="#logs">Logs</a></li>
          <li class="tab col s3 xdisabled"><a href="#settings">Settings</a></li>
          <li class="tab col s3 xdisabled"><a href="#billing">Billing</a></li>
        </ul>
      </div>
    </div>
  </div>

  <div class="container">
    <div class="row">
      <div id="logs" class="col s12">
        <div class="panel white grey-text text-darken-3">
        </div>
      </div>
      <div id="settings" class="col s12">
        <div class="panel white grey-text text-darken-3">
        </div>
      </div>
      <div id="billing" class="col s12">
        <div class="panel white grey-text text-darken-3">
        </div>        
      </div>
    </div>
  </div>

  <footer class="page-footer blue-grey darken-2">
    <div class="container small center">
      A brand of <a href="www.revolutionarysystems.co.uk">Revolutionary Systems</a>
    </div>
    <div class="footer-copyright darken-4">
      <div class="container small">
        v0.9
      </div>
    </div>
  </footer>

  <div id="baseModal" class="modal modal-fixed-footer">
    <div class="modal-content black-text">
      <h4>Set a base name</h4>
      <p>
        Looks like it's your first time here.<br>
        Please choose a unique <em>base name</em> that we can use to identify your account.  The base name is used to help form the email addresses that you will set up.
      </p>
      <form class="row">
        <div class="col s12">
          Base name:
          <div class="input-field inline">
            <input id="baseField" type="text" class="validate">
            <span class="helper-text" data-error="wrong" data-success="right">A good base name is between 3 and 8 characters long, and must not contain any non-letter characters</span>
          </div>
        </div>
      </form>
    </div>
    <div class="modal-footer orange">
      <a href="#!" class="modal-action modal-close waves-effect waves-green btn-flat">Done</a>
    </div>
  </div>

  <!--  Scripts-->
  <script src="https://code.jquery.com/jquery-2.1.1.min.js"></script>
  <script src="js/materialize.js"></script>
  <script>
    var uiTabs = M.Tabs.init(document.getElementById('uiTabs'), {swipeable: true});
  </script>
  <script src="js/init.js"></script>
  <script src="https://identity.netlify.com/v1/netlify-identity-widget.js"></script>
  <script>
    $(function(){
      netlifyIdentity.on("error", err => console.error(err));
      netlifyIdentity.on("logout", () => location.reload());
      netlifyIdentity.on("login", user => {
          console.log('logged in', user.email, user.id);

          if (!user.user_metadata.base) {
            console.log('need to set base');
            var instance = M.Modal.init(document.getElementById('baseModal', {dismissible: false}));
            instance.open();
          }
      });
    });
  </script>
</body>
</html>
